{"ast":null,"code":"/**\r\n * Server Selection System v1.0.3\r\n * Manual server selection - no auto-switching\r\n */\n\nconst SERVERS = {\n  production: {\n    name: 'Production (Railway)',\n    url: process.env.REACT_APP_API_URL || 'https://your-app.onrender.com/api',\n    description: 'Main production server',\n    icon: 'ðŸš€',\n    color: '#10b981'\n  },\n  backup: {\n    name: 'Backup (Railway)',\n    url: process.env.REACT_APP_API_URL_BACKUP || 'https://your-app.railway.app/api',\n    description: 'Backup production server',\n    icon: 'ðŸ”„',\n    color: '#3b82f6'\n  },\n  development: {\n    name: 'Development (Local)',\n    url: process.env.REACT_APP_API_URL_DEV || 'http://localhost:5000/api',\n    description: 'Local development server',\n    icon: 'ðŸ’»',\n    color: '#8b5cf6'\n  }\n};\nclass ServerSelector {\n  constructor() {\n    // Load saved server from localStorage or default to production\n    const savedServer = localStorage.getItem('selectedServer');\n    this.currentServer = savedServer || 'production';\n    this.serverStatus = new Map();\n\n    // Initialize status\n    Object.keys(SERVERS).forEach(key => {\n      this.serverStatus.set(key, 'unknown');\n    });\n  }\n\n  /**\r\n   * Get current selected server\r\n   */\n  getCurrentServer() {\n    return SERVERS[this.currentServer];\n  }\n\n  /**\r\n   * Get current server URL\r\n   */\n  getCurrentURL() {\n    return SERVERS[this.currentServer].url;\n  }\n\n  /**\r\n   * Switch to a different server\r\n   */\n  switchServer(serverKey) {\n    if (SERVERS[serverKey]) {\n      this.currentServer = serverKey;\n      localStorage.setItem('selectedServer', serverKey);\n\n      // Notify listeners\n      this.notifyServerChange(serverKey);\n      return true;\n    }\n    return false;\n  }\n\n  /**\r\n   * Get all available servers\r\n   */\n  getServers() {\n    return Object.entries(SERVERS).map(([key, server]) => ({\n      key,\n      ...server,\n      status: this.serverStatus.get(key),\n      isCurrent: key === this.currentServer\n    }));\n  }\n\n  /**\r\n   * Check health of a specific server\r\n   */\n  async checkServerHealth(serverKey) {\n    const server = SERVERS[serverKey];\n    if (!server) return false;\n    const controller = new AbortController();\n    const timeoutId = setTimeout(() => controller.abort(), 5000);\n    try {\n      const response = await fetch(`${server.url}/health`, {\n        method: 'GET',\n        signal: controller.signal,\n        headers: {\n          'Content-Type': 'application/json'\n        }\n      });\n      clearTimeout(timeoutId);\n      if (response.ok) {\n        this.serverStatus.set(serverKey, 'online');\n        return true;\n      }\n      throw new Error('Health check failed');\n    } catch (error) {\n      clearTimeout(timeoutId);\n      this.serverStatus.set(serverKey, 'offline');\n      console.warn(`âŒ ${server.name} is offline:`, error.message);\n      return false;\n    }\n  }\n\n  /**\r\n   * Check all servers\r\n   */\n  async checkAllServers() {\n    console.log('ðŸ” Checking all servers...');\n    const checks = Object.keys(SERVERS).map(key => this.checkServerHealth(key));\n    await Promise.allSettled(checks);\n\n    // Log status\n    Object.entries(SERVERS).forEach(([key, server]) => {\n      const status = this.serverStatus.get(key);\n      const icon = status === 'online' ? 'âœ…' : 'âŒ';\n      console.log(`${icon} ${server.name}: ${status}`);\n    });\n  }\n\n  /**\r\n   * Get server status\r\n   */\n  getStatus(serverKey) {\n    return this.serverStatus.get(serverKey);\n  }\n\n  /**\r\n   * Notify listeners of server change\r\n   */\n  notifyServerChange(serverKey) {\n    const event = new CustomEvent('server-changed', {\n      detail: {\n        server: SERVERS[serverKey],\n        key: serverKey\n      }\n    });\n    window.dispatchEvent(event);\n  }\n}\n\n// Singleton instance\nconst serverSelector = new ServerSelector();\n\n// Check servers on load\nserverSelector.checkAllServers();\n\n// Periodic health check (every 60 seconds)\nsetInterval(() => {\n  serverSelector.checkAllServers();\n}, 60000);\nexport default serverSelector;","map":{"version":3,"names":["SERVERS","production","name","url","process","env","REACT_APP_API_URL","description","icon","color","backup","REACT_APP_API_URL_BACKUP","development","REACT_APP_API_URL_DEV","ServerSelector","constructor","savedServer","localStorage","getItem","currentServer","serverStatus","Map","Object","keys","forEach","key","set","getCurrentServer","getCurrentURL","switchServer","serverKey","setItem","notifyServerChange","getServers","entries","map","server","status","get","isCurrent","checkServerHealth","controller","AbortController","timeoutId","setTimeout","abort","response","fetch","method","signal","headers","clearTimeout","ok","Error","error","console","warn","message","checkAllServers","log","checks","Promise","allSettled","getStatus","event","CustomEvent","detail","window","dispatchEvent","serverSelector","setInterval"],"sources":["E:/Self/QRGenerator/qrweb/frontend/src/services/serverSelector.js"],"sourcesContent":["/**\r\n * Server Selection System v1.0.3\r\n * Manual server selection - no auto-switching\r\n */\r\n\r\nconst SERVERS = {\r\n    production: {\r\n      name: 'Production (Railway)',\r\n      url: process.env.REACT_APP_API_URL || 'https://your-app.onrender.com/api',\r\n      description: 'Main production server',\r\n      icon: 'ðŸš€',\r\n      color: '#10b981'\r\n    },\r\n    backup: {\r\n      name: 'Backup (Railway)',\r\n      url: process.env.REACT_APP_API_URL_BACKUP || 'https://your-app.railway.app/api',\r\n      description: 'Backup production server',\r\n      icon: 'ðŸ”„',\r\n      color: '#3b82f6'\r\n    },\r\n    development: {\r\n      name: 'Development (Local)',\r\n      url: process.env.REACT_APP_API_URL_DEV || 'http://localhost:5000/api',\r\n      description: 'Local development server',\r\n      icon: 'ðŸ’»',\r\n      color: '#8b5cf6'\r\n    }\r\n  };\r\n  \r\n  class ServerSelector {\r\n    constructor() {\r\n      // Load saved server from localStorage or default to production\r\n      const savedServer = localStorage.getItem('selectedServer');\r\n      this.currentServer = savedServer || 'production';\r\n      this.serverStatus = new Map();\r\n      \r\n      // Initialize status\r\n      Object.keys(SERVERS).forEach(key => {\r\n        this.serverStatus.set(key, 'unknown');\r\n      });\r\n    }\r\n  \r\n    /**\r\n     * Get current selected server\r\n     */\r\n    getCurrentServer() {\r\n      return SERVERS[this.currentServer];\r\n    }\r\n  \r\n    /**\r\n     * Get current server URL\r\n     */\r\n    getCurrentURL() {\r\n      return SERVERS[this.currentServer].url;\r\n    }\r\n  \r\n    /**\r\n     * Switch to a different server\r\n     */\r\n    switchServer(serverKey) {\r\n      if (SERVERS[serverKey]) {\r\n        this.currentServer = serverKey;\r\n        localStorage.setItem('selectedServer', serverKey);\r\n        \r\n        // Notify listeners\r\n        this.notifyServerChange(serverKey);\r\n        \r\n        return true;\r\n      }\r\n      return false;\r\n    }\r\n  \r\n    /**\r\n     * Get all available servers\r\n     */\r\n    getServers() {\r\n      return Object.entries(SERVERS).map(([key, server]) => ({\r\n        key,\r\n        ...server,\r\n        status: this.serverStatus.get(key),\r\n        isCurrent: key === this.currentServer\r\n      }));\r\n    }\r\n  \r\n    /**\r\n     * Check health of a specific server\r\n     */\r\n    async checkServerHealth(serverKey) {\r\n      const server = SERVERS[serverKey];\r\n      if (!server) return false;\r\n  \r\n      const controller = new AbortController();\r\n      const timeoutId = setTimeout(() => controller.abort(), 5000);\r\n  \r\n      try {\r\n        const response = await fetch(`${server.url}/health`, {\r\n          method: 'GET',\r\n          signal: controller.signal,\r\n          headers: { 'Content-Type': 'application/json' }\r\n        });\r\n  \r\n        clearTimeout(timeoutId);\r\n  \r\n        if (response.ok) {\r\n          this.serverStatus.set(serverKey, 'online');\r\n          return true;\r\n        }\r\n  \r\n        throw new Error('Health check failed');\r\n  \r\n      } catch (error) {\r\n        clearTimeout(timeoutId);\r\n        this.serverStatus.set(serverKey, 'offline');\r\n        console.warn(`âŒ ${server.name} is offline:`, error.message);\r\n        return false;\r\n      }\r\n    }\r\n  \r\n    /**\r\n     * Check all servers\r\n     */\r\n    async checkAllServers() {\r\n      console.log('ðŸ” Checking all servers...');\r\n      \r\n      const checks = Object.keys(SERVERS).map(key => \r\n        this.checkServerHealth(key)\r\n      );\r\n      \r\n      await Promise.allSettled(checks);\r\n  \r\n      // Log status\r\n      Object.entries(SERVERS).forEach(([key, server]) => {\r\n        const status = this.serverStatus.get(key);\r\n        const icon = status === 'online' ? 'âœ…' : 'âŒ';\r\n        console.log(`${icon} ${server.name}: ${status}`);\r\n      });\r\n    }\r\n  \r\n    /**\r\n     * Get server status\r\n     */\r\n    getStatus(serverKey) {\r\n      return this.serverStatus.get(serverKey);\r\n    }\r\n  \r\n    /**\r\n     * Notify listeners of server change\r\n     */\r\n    notifyServerChange(serverKey) {\r\n      const event = new CustomEvent('server-changed', {\r\n        detail: { \r\n          server: SERVERS[serverKey],\r\n          key: serverKey\r\n        }\r\n      });\r\n      window.dispatchEvent(event);\r\n    }\r\n  }\r\n  \r\n  // Singleton instance\r\n  const serverSelector = new ServerSelector();\r\n  \r\n  // Check servers on load\r\n  serverSelector.checkAllServers();\r\n  \r\n  // Periodic health check (every 60 seconds)\r\n  setInterval(() => {\r\n    serverSelector.checkAllServers();\r\n  }, 60000);\r\n  \r\n  export default serverSelector;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}