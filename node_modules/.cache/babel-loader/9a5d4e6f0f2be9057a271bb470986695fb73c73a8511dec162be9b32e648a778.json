{"ast":null,"code":"import axios from 'axios';\nimport serverSelector from './serverSelector';\n\n// Use server selector for API URL\nconst getAPIUrl = () => {\n  return serverSelector.getCurrentURL();\n};\nconsole.log('ðŸ”— Initial API URL:', getAPIUrl());\n\n// Listen for server changes\nwindow.addEventListener('server-changed', event => {\n  console.log(`ðŸ”„ Switched to: ${event.detail.server.name}`);\n  console.log(`ðŸ“ URL: ${event.detail.server.url}`);\n});\n\n// Create axios instance with dynamic base URL\nconst api = axios.create({\n  headers: {\n    'Content-Type': 'application/json'\n  },\n  timeout: 30000,\n  withCredentials: true\n});\n\n// Request interceptor - use current server URL\napi.interceptors.request.use(config => {\n  config.baseURL = getAPIUrl();\n  if (process.env.NODE_ENV === 'development') {\n    console.log(`ðŸ“¤ API Request: ${config.method.toUpperCase()} ${config.url}`);\n    console.log(`ðŸŒ Server: ${serverSelector.getCurrentServer().name}`);\n  }\n  return config;\n}, error => {\n  console.error('âŒ Request Error:', error);\n  return Promise.reject(error);\n});\n\n// Response interceptor with better error handling\napi.interceptors.response.use(response => {\n  if (process.env.NODE_ENV === 'development') {\n    console.log('ðŸ“¥ API Response:', response.status, response.data);\n  }\n  return response;\n}, async error => {\n  var _error$config, _error$response, _error$response2, _error$response2$data;\n  console.error('âŒ API Error:', {\n    url: (_error$config = error.config) === null || _error$config === void 0 ? void 0 : _error$config.url,\n    status: (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status,\n    message: ((_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.error) || error.message,\n    server: serverSelector.getCurrentServer().name\n  });\n  return Promise.reject(error);\n});\n\n// QR Code API functions\nexport const qrAPI = {\n  // Generate new QR code\n  generate: async (originalUrl, createdBy = 'anonymous', customization = {}) => {\n    try {\n      const response = await api.post('/qr/generate', {\n        originalUrl,\n        createdBy,\n        customization\n      });\n      return response.data;\n    } catch (error) {\n      var _error$response3, _error$response3$data;\n      throw new Error(((_error$response3 = error.response) === null || _error$response3 === void 0 ? void 0 : (_error$response3$data = _error$response3.data) === null || _error$response3$data === void 0 ? void 0 : _error$response3$data.error) || 'Failed to generate QR code');\n    }\n  },\n  // Get all QR codes with pagination\n  list: async (params = {}) => {\n    try {\n      const {\n        limit = 100,\n        page = 1,\n        sortBy = 'createdAt',\n        order = 'desc'\n      } = params;\n      const response = await api.get('/qr/list', {\n        params: {\n          limit,\n          page,\n          sortBy,\n          order\n        }\n      });\n      return response.data;\n    } catch (error) {\n      var _error$response4, _error$response4$data;\n      throw new Error(((_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.error) || 'Failed to fetch QR codes');\n    }\n  },\n  // Get single QR code by ID\n  getById: async id => {\n    try {\n      const response = await api.get(`/qr/${id}`);\n      return response.data;\n    } catch (error) {\n      var _error$response5, _error$response5$data;\n      throw new Error(((_error$response5 = error.response) === null || _error$response5 === void 0 ? void 0 : (_error$response5$data = _error$response5.data) === null || _error$response5$data === void 0 ? void 0 : _error$response5$data.error) || 'Failed to fetch QR code');\n    }\n  },\n  // Delete QR code\n  delete: async id => {\n    try {\n      const response = await api.delete(`/qr/${id}`);\n      return response.data;\n    } catch (error) {\n      var _error$response6, _error$response6$data;\n      throw new Error(((_error$response6 = error.response) === null || _error$response6 === void 0 ? void 0 : (_error$response6$data = _error$response6.data) === null || _error$response6$data === void 0 ? void 0 : _error$response6$data.error) || 'Failed to delete QR code');\n    }\n  },\n  // Get QR code statistics\n  getStats: async id => {\n    try {\n      const response = await api.get(`/qr/stats/${id}`);\n      return response.data;\n    } catch (error) {\n      var _error$response7, _error$response7$data;\n      throw new Error(((_error$response7 = error.response) === null || _error$response7 === void 0 ? void 0 : (_error$response7$data = _error$response7.data) === null || _error$response7$data === void 0 ? void 0 : _error$response7$data.error) || 'Failed to fetch statistics');\n    }\n  }\n};\n\n// Health check with detailed info\nexport const healthCheck = async () => {\n  try {\n    const response = await api.get('/health');\n    return {\n      status: 'OK',\n      ...response.data,\n      server: serverSelector.getCurrentServer()\n    };\n  } catch (error) {\n    var _error$response8;\n    return {\n      status: 'ERROR',\n      error: error.message,\n      details: (_error$response8 = error.response) === null || _error$response8 === void 0 ? void 0 : _error$response8.data,\n      server: serverSelector.getCurrentServer()\n    };\n  }\n};\n\n// Get all servers with status\nexport const getServers = () => {\n  return serverSelector.getServers();\n};\n\n// Switch server\nexport const switchServer = serverKey => {\n  return serverSelector.switchServer(serverKey);\n};\n\n// Check server health\nexport const checkServerHealth = serverKey => {\n  return serverSelector.checkServerHealth(serverKey);\n};\nexport default api;","map":{"version":3,"names":["axios","serverSelector","getAPIUrl","getCurrentURL","console","log","window","addEventListener","event","detail","server","name","url","api","create","headers","timeout","withCredentials","interceptors","request","use","config","baseURL","process","env","NODE_ENV","method","toUpperCase","getCurrentServer","error","Promise","reject","response","status","data","_error$config","_error$response","_error$response2","_error$response2$data","message","qrAPI","generate","originalUrl","createdBy","customization","post","_error$response3","_error$response3$data","Error","list","params","limit","page","sortBy","order","get","_error$response4","_error$response4$data","getById","id","_error$response5","_error$response5$data","delete","_error$response6","_error$response6$data","getStats","_error$response7","_error$response7$data","healthCheck","_error$response8","details","getServers","switchServer","serverKey","checkServerHealth"],"sources":["E:/Self/QRGenerator/qrweb/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport serverSelector from './serverSelector';\r\n\r\n// Use server selector for API URL\r\nconst getAPIUrl = () => {\r\n  return serverSelector.getCurrentURL();\r\n};\r\n\r\nconsole.log('ðŸ”— Initial API URL:', getAPIUrl());\r\n\r\n// Listen for server changes\r\nwindow.addEventListener('server-changed', (event) => {\r\n  console.log(`ðŸ”„ Switched to: ${event.detail.server.name}`);\r\n  console.log(`ðŸ“ URL: ${event.detail.server.url}`);\r\n});\r\n\r\n// Create axios instance with dynamic base URL\r\nconst api = axios.create({\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 30000,\r\n  withCredentials: true\r\n});\r\n\r\n// Request interceptor - use current server URL\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    config.baseURL = getAPIUrl();\r\n    \r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(`ðŸ“¤ API Request: ${config.method.toUpperCase()} ${config.url}`);\r\n      console.log(`ðŸŒ Server: ${serverSelector.getCurrentServer().name}`);\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('âŒ Request Error:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor with better error handling\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log('ðŸ“¥ API Response:', response.status, response.data);\r\n    }\r\n    return response;\r\n  },\r\n  async (error) => {\r\n    console.error('âŒ API Error:', {\r\n      url: error.config?.url,\r\n      status: error.response?.status,\r\n      message: error.response?.data?.error || error.message,\r\n      server: serverSelector.getCurrentServer().name\r\n    });\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// QR Code API functions\r\nexport const qrAPI = {\r\n  // Generate new QR code\r\n  generate: async (originalUrl, createdBy = 'anonymous', customization = {}) => {\r\n    try {\r\n      const response = await api.post('/qr/generate', {\r\n        originalUrl,\r\n        createdBy,\r\n        customization\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to generate QR code');\r\n    }\r\n  },\r\n\r\n  // Get all QR codes with pagination\r\n  list: async (params = {}) => {\r\n    try {\r\n      const { limit = 100, page = 1, sortBy = 'createdAt', order = 'desc' } = params;\r\n      const response = await api.get('/qr/list', {\r\n        params: { limit, page, sortBy, order },\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch QR codes');\r\n    }\r\n  },\r\n\r\n  // Get single QR code by ID\r\n  getById: async (id) => {\r\n    try {\r\n      const response = await api.get(`/qr/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch QR code');\r\n    }\r\n  },\r\n\r\n  // Delete QR code\r\n  delete: async (id) => {\r\n    try {\r\n      const response = await api.delete(`/qr/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to delete QR code');\r\n    }\r\n  },\r\n\r\n  // Get QR code statistics\r\n  getStats: async (id) => {\r\n    try {\r\n      const response = await api.get(`/qr/stats/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch statistics');\r\n    }\r\n  },\r\n};\r\n\r\n// Health check with detailed info\r\nexport const healthCheck = async () => {\r\n  try {\r\n    const response = await api.get('/health');\r\n    return { \r\n      status: 'OK', \r\n      ...response.data,\r\n      server: serverSelector.getCurrentServer()\r\n    };\r\n  } catch (error) {\r\n    return { \r\n      status: 'ERROR', \r\n      error: error.message,\r\n      details: error.response?.data,\r\n      server: serverSelector.getCurrentServer()\r\n    };\r\n  }\r\n};\r\n\r\n// Get all servers with status\r\nexport const getServers = () => {\r\n  return serverSelector.getServers();\r\n};\r\n\r\n// Switch server\r\nexport const switchServer = (serverKey) => {\r\n  return serverSelector.switchServer(serverKey);\r\n};\r\n\r\n// Check server health\r\nexport const checkServerHealth = (serverKey) => {\r\n  return serverSelector.checkServerHealth(serverKey);\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}