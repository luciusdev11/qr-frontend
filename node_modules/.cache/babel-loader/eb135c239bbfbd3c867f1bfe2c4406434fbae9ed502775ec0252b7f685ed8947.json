{"ast":null,"code":"import _objectSpread from\"E:/Self/QRGenerator/qrweb/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import axios from'axios';import serverSelector from'./serverSelector';// Use server selector for API URL\nconst getAPIUrl=()=>{return serverSelector.getCurrentURL();};console.log('ðŸ”— Initial API URL:',getAPIUrl());// Listen for server changes\nwindow.addEventListener('server-changed',event=>{console.log(\"\\uD83D\\uDD04 Switched to: \".concat(event.detail.server.name));console.log(\"\\uD83D\\uDCCD URL: \".concat(event.detail.server.url));});// Create axios instance with dynamic base URL\nconst api=axios.create({headers:{'Content-Type':'application/json'},timeout:30000,withCredentials:true});// Request interceptor - use current server URL\napi.interceptors.request.use(config=>{config.baseURL=getAPIUrl();if(process.env.NODE_ENV==='development'){console.log(\"\\uD83D\\uDCE4 API Request: \".concat(config.method.toUpperCase(),\" \").concat(config.url));console.log(\"\\uD83C\\uDF10 Server: \".concat(serverSelector.getCurrentServer().name));}return config;},error=>{console.error('âŒ Request Error:',error);return Promise.reject(error);});// Response interceptor with better error handling\napi.interceptors.response.use(response=>{if(process.env.NODE_ENV==='development'){console.log('ðŸ“¥ API Response:',response.status,response.data);}return response;},async error=>{var _error$config,_error$response,_error$response2,_error$response2$data;console.error('âŒ API Error:',{url:(_error$config=error.config)===null||_error$config===void 0?void 0:_error$config.url,status:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status,message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.error)||error.message,server:serverSelector.getCurrentServer().name});return Promise.reject(error);});// QR Code API functions\nexport const qrAPI={// Generate new QR code\ngenerate:async function(originalUrl){let createdBy=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'anonymous';let customization=arguments.length>2&&arguments[2]!==undefined?arguments[2]:{};try{const response=await api.post('/qr/generate',{originalUrl,createdBy,customization});return response.data;}catch(error){var _error$response3,_error$response3$data;throw new Error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Failed to generate QR code');}},// Get all QR codes with pagination\nlist:async function(){let params=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};try{const{limit=100,page=1,sortBy='createdAt',order='desc'}=params;const response=await api.get('/qr/list',{params:{limit,page,sortBy,order}});return response.data;}catch(error){var _error$response4,_error$response4$data;throw new Error(((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||'Failed to fetch QR codes');}},// Get single QR code by ID\ngetById:async id=>{try{const response=await api.get(\"/qr/\".concat(id));return response.data;}catch(error){var _error$response5,_error$response5$data;throw new Error(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||'Failed to fetch QR code');}},// Delete QR code\ndelete:async id=>{try{const response=await api.delete(\"/qr/\".concat(id));return response.data;}catch(error){var _error$response6,_error$response6$data;throw new Error(((_error$response6=error.response)===null||_error$response6===void 0?void 0:(_error$response6$data=_error$response6.data)===null||_error$response6$data===void 0?void 0:_error$response6$data.error)||'Failed to delete QR code');}},// Get QR code statistics\ngetStats:async id=>{try{const response=await api.get(\"/qr/stats/\".concat(id));return response.data;}catch(error){var _error$response7,_error$response7$data;throw new Error(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.error)||'Failed to fetch statistics');}}};// Health check with detailed info\nexport const healthCheck=async()=>{try{const response=await api.get('/health');return _objectSpread(_objectSpread({status:'OK'},response.data),{},{server:serverSelector.getCurrentServer()});}catch(error){var _error$response8;return{status:'ERROR',error:error.message,details:(_error$response8=error.response)===null||_error$response8===void 0?void 0:_error$response8.data,server:serverSelector.getCurrentServer()};}};// Get all servers with status\nexport const getServers=()=>{return serverSelector.getServers();};// Switch server\nexport const switchServer=serverKey=>{return serverSelector.switchServer(serverKey);};// Check server health\nexport const checkServerHealth=serverKey=>{return serverSelector.checkServerHealth(serverKey);};export default api;","map":{"version":3,"names":["axios","serverSelector","getAPIUrl","getCurrentURL","console","log","window","addEventListener","event","concat","detail","server","name","url","api","create","headers","timeout","withCredentials","interceptors","request","use","config","baseURL","process","env","NODE_ENV","method","toUpperCase","getCurrentServer","error","Promise","reject","response","status","data","_error$config","_error$response","_error$response2","_error$response2$data","message","qrAPI","generate","originalUrl","createdBy","arguments","length","undefined","customization","post","_error$response3","_error$response3$data","Error","list","params","limit","page","sortBy","order","get","_error$response4","_error$response4$data","getById","id","_error$response5","_error$response5$data","delete","_error$response6","_error$response6$data","getStats","_error$response7","_error$response7$data","healthCheck","_objectSpread","_error$response8","details","getServers","switchServer","serverKey","checkServerHealth"],"sources":["E:/Self/QRGenerator/qrweb/frontend/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\nimport serverSelector from './serverSelector';\r\n\r\n// Use server selector for API URL\r\nconst getAPIUrl = () => {\r\n  return serverSelector.getCurrentURL();\r\n};\r\n\r\nconsole.log('ðŸ”— Initial API URL:', getAPIUrl());\r\n\r\n// Listen for server changes\r\nwindow.addEventListener('server-changed', (event) => {\r\n  console.log(`ðŸ”„ Switched to: ${event.detail.server.name}`);\r\n  console.log(`ðŸ“ URL: ${event.detail.server.url}`);\r\n});\r\n\r\n// Create axios instance with dynamic base URL\r\nconst api = axios.create({\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n  timeout: 30000,\r\n  withCredentials: true\r\n});\r\n\r\n// Request interceptor - use current server URL\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    config.baseURL = getAPIUrl();\r\n    \r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log(`ðŸ“¤ API Request: ${config.method.toUpperCase()} ${config.url}`);\r\n      console.log(`ðŸŒ Server: ${serverSelector.getCurrentServer().name}`);\r\n    }\r\n    return config;\r\n  },\r\n  (error) => {\r\n    console.error('âŒ Request Error:', error);\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Response interceptor with better error handling\r\napi.interceptors.response.use(\r\n  (response) => {\r\n    if (process.env.NODE_ENV === 'development') {\r\n      console.log('ðŸ“¥ API Response:', response.status, response.data);\r\n    }\r\n    return response;\r\n  },\r\n  async (error) => {\r\n    console.error('âŒ API Error:', {\r\n      url: error.config?.url,\r\n      status: error.response?.status,\r\n      message: error.response?.data?.error || error.message,\r\n      server: serverSelector.getCurrentServer().name\r\n    });\r\n\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// QR Code API functions\r\nexport const qrAPI = {\r\n  // Generate new QR code\r\n  generate: async (originalUrl, createdBy = 'anonymous', customization = {}) => {\r\n    try {\r\n      const response = await api.post('/qr/generate', {\r\n        originalUrl,\r\n        createdBy,\r\n        customization\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to generate QR code');\r\n    }\r\n  },\r\n\r\n  // Get all QR codes with pagination\r\n  list: async (params = {}) => {\r\n    try {\r\n      const { limit = 100, page = 1, sortBy = 'createdAt', order = 'desc' } = params;\r\n      const response = await api.get('/qr/list', {\r\n        params: { limit, page, sortBy, order },\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch QR codes');\r\n    }\r\n  },\r\n\r\n  // Get single QR code by ID\r\n  getById: async (id) => {\r\n    try {\r\n      const response = await api.get(`/qr/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch QR code');\r\n    }\r\n  },\r\n\r\n  // Delete QR code\r\n  delete: async (id) => {\r\n    try {\r\n      const response = await api.delete(`/qr/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to delete QR code');\r\n    }\r\n  },\r\n\r\n  // Get QR code statistics\r\n  getStats: async (id) => {\r\n    try {\r\n      const response = await api.get(`/qr/stats/${id}`);\r\n      return response.data;\r\n    } catch (error) {\r\n      throw new Error(error.response?.data?.error || 'Failed to fetch statistics');\r\n    }\r\n  },\r\n};\r\n\r\n// Health check with detailed info\r\nexport const healthCheck = async () => {\r\n  try {\r\n    const response = await api.get('/health');\r\n    return { \r\n      status: 'OK', \r\n      ...response.data,\r\n      server: serverSelector.getCurrentServer()\r\n    };\r\n  } catch (error) {\r\n    return { \r\n      status: 'ERROR', \r\n      error: error.message,\r\n      details: error.response?.data,\r\n      server: serverSelector.getCurrentServer()\r\n    };\r\n  }\r\n};\r\n\r\n// Get all servers with status\r\nexport const getServers = () => {\r\n  return serverSelector.getServers();\r\n};\r\n\r\n// Switch server\r\nexport const switchServer = (serverKey) => {\r\n  return serverSelector.switchServer(serverKey);\r\n};\r\n\r\n// Check server health\r\nexport const checkServerHealth = (serverKey) => {\r\n  return serverSelector.checkServerHealth(serverKey);\r\n};\r\n\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}